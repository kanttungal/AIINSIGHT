{% extends 'blog/base.html' %}

{% block title %}AI/ML Blog - Latest Articles{% endblock %}

{% block content %}
<!-- Home Page Cube Background -->
<div class="cube-bg">
    <div class="cube" style="left: 10%; animation-delay: 0s;"></div>
    <div class="cube" style="left: 20%; top: 30%; animation-delay: 2s;"></div>
    <div class="cube" style="left: 70%; top: 50%; animation-delay: 4s;"></div>
    <div class="cube" style="left: 80%; top: 80%; animation-delay: 6s;"></div>
    <div class="cube" style="left: 40%; top: 70%; animation-delay: 1s;"></div>
    <div class="cube" style="left: 5%; top: 20%; animation-delay: 3s; width: 80px; height: 80px;"></div>
    <div class="cube" style="left: 60%; top: 10%; animation-delay: 5s; width: 50px; height: 50px;"></div>
    <div class="cube" style="left: 90%; top: 60%; animation-delay: 7s; width: 70px; height: 70px;"></div>
</div>

<style>
.cube-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    pointer-events: none;
    overflow: hidden;
}

.cube {
    position: absolute;
    width: 60px;
    height: 60px;
    border-radius: 0;
    transform-style: preserve-3d;
    animation: floatCube 25s infinite ease-in-out, rotateCube 10s infinite linear;
    box-shadow: 0 0 30px rgba(102, 126, 234, 0.6);
    border: 2px solid rgba(255, 255, 255, 0.4);
}

.cube {
    /* Front face */
    position: relative;
}

.cube::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
    transform: rotateY(0deg) translateZ(30px);
    animation: inherit;
    box-shadow: inherit;
    border: inherit;
    border-radius: 0;
}

.cube::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background: linear-gradient(135deg, rgba(118, 75, 162, 0.8) 0%, rgba(79, 172, 254, 0.8) 100%);
    transform: rotateX(90deg) translateZ(30px);
    animation: inherit;
    box-shadow: inherit;
    border: inherit;
    border-radius: 0;
}

.cube .face-side {
    content: '';
    position: absolute;
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, rgba(79, 172, 254, 0.7) 0%, rgba(102, 126, 234, 0.7) 100%);
    border-radius: 0;
}

@keyframes floatCube {
    0%, 100% { transform: translateY(0px) translateX(0px) rotateX(0deg) rotateY(0deg); }
    25% { transform: translateY(-30px) translateX(15px) rotateX(90deg) rotateY(45deg); }
    50% { transform: translateY(-50px) translateX(0px) rotateX(180deg) rotateY(90deg); }
    75% { transform: translateY(-30px) translateX(-15px) rotateX(270deg) rotateY(135deg); }
}

@keyframes rotateCube {
    0% { transform: rotateX(0deg) rotateY(0deg); }
    100% { transform: rotateX(360deg) rotateY(360deg); }
}

@media (max-width: 768px) {
    .cube {
        width: 40px;
        height: 40px;
    }
    .cube::before, .cube::after {
        width: 40px;
        height: 40px;
        transform: translateZ(20px);
    }
}

/* Home Page Theme Customization Based on Cubes */
.home-theme {
    background: rgba(15, 12, 41, 0.8);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 2rem;
    margin: 1rem 0;
    border: 1px solid rgba(102, 126, 234, 0.3);
}

.home-theme h2 {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
}

.home-theme .card {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
    border: 1px solid rgba(102, 126, 234, 0.3);
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
}

.home-theme .btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    transition: all 0.3s ease;
}

.home-theme .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
}

.home-theme .card-title a {
    color: #ffffff;
    transition: color 0.3s ease;
}

.home-theme .card-title a:hover {
    color: #667eea;
    text-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
}

.home-theme .article-meta {
    color: rgba(255, 255, 255, 0.8) !important;
}

.home-theme .pagination .page-link {
    background: rgba(102, 126, 234, 0.1);
    border: 1px solid rgba(102, 126, 234, 0.3);
    color: #ffffff;
}

.home-theme .pagination .page-item.active .page-link {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-color: rgba(102, 126, 234, 0.5);
}
</style>
<!-- Recent Posts Section -->
{% if not category and not tag %}
<div class="home-theme">
    <div class="row mb-5">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0">Recent Posts</h2>
            </div>
        </div>
    </div>

    <div class="row mb-5">
        {% for post in latest_posts %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 hover-lift">
                <div class="card-body d-flex flex-column">
                    <h3 class="card-title">
                        <a href="{{ post.get_absolute_url }}" class="text-decoration-none">{{ post.title }}</a>
                    </h3>
                    <p class="card-text text-muted article-meta flex-grow-1">
                        <small>
                            By {{ post.author }} on {{ post.created_at|date:"F d, Y" }} in 
                            <a href="{% url 'blog:post_list_by_category' post.category.slug %}" class="text-decoration-none">
                                {{ post.category }}
                            </a>
                        </small>
                    </p>
                    <p class="card-text">{{ post.excerpt|safe }}</p>
                    <a href="{{ post.get_absolute_url }}" class="btn btn-primary mt-auto">Read More</a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="card mb-4">
                <div class="card-body">
                    <p class="mb-0">No recent posts available.</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- All Posts Section -->
<div class="home-theme">
    <div class="row">
        <div class="col-12">
            <h2 class="mb-4">
                {% if category %}
                    Posts in "{{ category.name }}"
                {% elif tag %}
                    Posts tagged with "{{ tag.name }}"
                {% else %}
                    All Posts
                {% endif %}
            </h2>
        </div>
    </div>

    <div class="row">
        {% for post in page_obj %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 hover-lift">
                <div class="card-body d-flex flex-column">
                    <h3 class="card-title">
                        <a href="{{ post.get_absolute_url }}" class="text-decoration-none">{{ post.title }}</a>
                    </h3>
                    <p class="card-text text-muted article-meta flex-grow-1">
                        <small>
                            By {{ post.author }} on {{ post.created_at|date:"F d, Y" }} in 
                            <a href="{% url 'blog:post_list_by_category' post.category.slug %}" class="text-decoration-none">
                                {{ post.category }}
                            </a>
                        </small>
                    </p>
                    <p class="card-text">{{ post.excerpt|safe }}</p>
                    <a href="{{ post.get_absolute_url }}" class="btn btn-primary mt-auto">Read More</a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="card mb-4">
                <div class="card-body">
                    <p class="mb-0">No posts found.</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if page_obj.has_other_pages %}
    <div class="row">
        <div class="col-12">
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
                        </li>
                    {% endif %}
                    
                    {% for num in page_obj.paginator.page_range %}
                        {% if page_obj.number == num %}
                            <li class="page-item active">
                                <span class="page-link">{{ num }}</span>
                            </li>
                        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                            </li>
                        {% endif %}
                    {% endfor %}
                    
                    {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
